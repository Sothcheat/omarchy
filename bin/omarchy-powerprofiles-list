#!/bin/bash

# Unified power profile lister
# Auto-detects PPD or TLP and calls appropriate backend

# Get script directory for reliable path resolution
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

if command -v tlp &>/dev/null && [[ -f /etc/tlp.d/00-omarchy-base.conf ]]; then
  # TLP is installed
  "$SCRIPT_DIR/omarchy-tlp-profile-list"
elif command -v powerprofilesctl &>/dev/null; then
  # PPD is installed
  powerprofilesctl list |
    awk '/^\s*[* ]\s*[a-zA-Z0-9\-]+:$/ { gsub(/^[*[:space:]]+|:$/,""); print }' |
    tac
else
  echo "Error: No power management system found" >&2
  exit 1
fi
